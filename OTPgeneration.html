<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="OTPgeneration.css">
<title>Password Change with OTP</title>
<style>
    /* Add your CSS styles here */
</style>
</head>
<body>
    <div id="passwordChangeForm">
        <h2>Password Change</h2>
        <style>
            body {
              background-image: url('otpback.jpg');
              background-repeat: no-repeat;
              background-attachment: fixed;
              background-size: 100% 100%;
            }
        </style>
        <input type="text" id="userId" placeholder="E-mail"><br><br>
        <button onclick="sendOTP()">Send OTP</button><br><br>
        <input type="text" id="otp" placeholder="Enter OTP"><br><br>
        <!-- <input type="password" id="newPassword" placeholder="New Password"><br><br> -->
        <button onclick="verifyOTP()">Verify OTP </button>
        <p id="message"></p>
    </div>

    <script>
        function sendOTP() {
            var userId = document.getElementById("userId").value;
            // console.log("34")
            //     // Check if the user is already registered
            //     const registeredUsers = JSON.parse(localStorage.getItem("registeredUsers")) || [];
            //     console.log("37",registeredUsers)
            //     const userExists = registeredUsers.some(user => userId === email);
            //     console.log("39",userExists)
            //     if (!userExists) {
            //         console.log("41")
            //         alert("User Doesn't exist");
            //         return;
            //     }
            // else{
            //     console.log("46")
                if (userId) {
                // Generate and send OTP (dummy implementation)
                var otp = Math.floor(100000 + Math.random() * 900000); // Generate OTP
                alert("OTP sent to your registered email or phone: " + otp); // Dummy OTP sending
                localStorage.setItem("otp_" + userId, otp); // Store OTP in localStorage
            } else {
                alert("Please provide your User ID.");
            }
        }
    

        function verifyOTP() {
            var userId = document.getElementById("userId").value;
            var enteredOTP = document.getElementById("otp").value;
            // var newPassword = document.getElementById("newPassword").value;
            if (userId && enteredOTP ) {//&& newPassword) {
                var storedOTP = localStorage.getItem("otp_" + userId);
                if (enteredOTP === storedOTP) {
                    // OTP verification successful, change password (dummy implementation)
                    alert("Login Successfull!!!!");
                    window.location.href = "product.html"; 
                    localStorage.removeItem("otp_" + userId); // Remove OTP from localStorage
                    // Code to change password in your backend goes here
                } else {
                    alert("Invalid OTP. Please try again.");
                }
            } else {
                alert("Please fill in all fields.");
            }

            
        }
    </script>
</body>
</html>
